# Use phusion/baseimage as base image. To make your builds
# reproducible, make sure you lock down to a specific version, not
# to `latest`! See
# https://github.com/phusion/baseimage-docker/blob/master/Changelog.md
# for a list of version numbers.
FROM phusion/baseimage
MAINTAINER fgg89

# Use baseimage-docker's init system.
CMD ["/sbin/my_init"]

# Update the repos
RUN apt-get update

RUN apt-get install -y hostapd dnsmasq  iptables ssh curl ntp
RUN echo "#!/bin/bash\n### START dnsmasq\nservice dnsmasq start > /dev/null 2>&1\n### START hostapd\nservice hostapd start > /dev/null 2>&1" > /usr/bin/start_ap
RUN echo "RUN_DAEMON=\"yes\"\nDAEMON_CONF=\"/etc/hostapd/hostapd.conf\"" >> /etc/default/hostapd
RUN chmod u+x /usr/bin/start_ap
RUN echo "server 172.17.0.3" >> /etc/ntp.conf
RUN mv /usr/sbin/ntpd /sbin/ntpd
RUN /sbin/ntpd

# Clean up APT when done.
RUN apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*
